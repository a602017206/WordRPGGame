# 双货币系统测试指南

## 🎯 测试目标
验证金币持久化修复和双货币系统的完整功能。

## ✅ 测试清单

### 测试1: 金币持久化修复验证 ⭐⭐⭐
**目的**: 验证刷新页面后金币不丢失

**步骤**:
1. 打开游戏 http://localhost:5173/
2. 选择或创建一个角色，进入冒险页面
3. 观察右上角货币显示，记录当前金币数（假设为0）
4. 点击"🎯 寻找敌人"开始战斗
5. 使用攻击或技能击败敌人
6. 观察战斗日志，记录获得的金币数（例如：获得15金币）
7. **刷新页面（F5）**
8. 观察金币数值

**预期结果**:
- ✅ 刷新前金币：15
- ✅ 刷新后金币：15（保持不变）
- ✅ 无控制台错误

**实际结果**: _______________

---

### 测试2: 钻石显示验证 ⭐⭐
**目的**: 验证钻石正确显示在界面上

**步骤**:
1. 进入冒险页面
2. 观察角色状态卡片右上角
3. 查看是否有两个货币显示：
   - 💰 金币（粉紫色背景）
   - 💎 钻石（蓝紫色背景）

**预期结果**:
- ✅ 金币和钻石分开显示
- ✅ 金币背景为粉紫色渐变
- ✅ 钻石背景为蓝紫色渐变
- ✅ 鼠标悬停时有提示信息

**实际结果**: _______________

---

### 测试3: 钻石掉落测试 ⭐⭐⭐
**目的**: 验证战斗胜利有概率获得钻石

**步骤**:
1. 进入冒险页面，记录初始钻石数（假设为0）
2. 进行10场战斗（多次点击"寻找敌人"并击败）
3. 观察战斗日志，查看是否有"额外获得X钻石！"的消息
4. 观察右上角钻石数值是否增加

**预期结果**:
- ✅ 10场战斗中约有1-2场获得钻石（10%概率）
- ✅ 每次获得1-3个钻石
- ✅ 战斗日志显示钻石获得信息
- ✅ 界面钻石数值实时更新

**实际结果**: 
- 战斗次数: _____
- 获得钻石次数: _____
- 总钻石数: _____

---

### 测试4: 钻石持久化测试 ⭐⭐⭐
**目的**: 验证钻石数据在刷新后保留

**步骤**:
1. 完成测试3，确保已获得一些钻石（假设有3个）
2. 记录当前钻石数
3. **刷新页面（F5）**
4. 观察钻石数值

**预期结果**:
- ✅ 刷新前钻石：3
- ✅ 刷新后钻石：3（保持不变）

**实际结果**: _______________

---

### 测试5: 钻石账号共享测试 ⭐⭐⭐⭐
**目的**: 验证钻石在所有角色间共享

**步骤**:
1. 使用角色A进入冒险，获得一些钻石（假设10个）
2. 记录钻石数：____
3. 返回角色列表（点击"← 返回"）
4. 切换到角色B（如果没有则创建一个）
5. 角色B进入冒险页面
6. 观察钻石数值

**预期结果**:
- ✅ 角色A钻石：10
- ✅ 角色B钻石：10（与角色A相同）
- ✅ 两个角色共享同一钻石池

**实际结果**: 
- 角色A钻石: _____
- 角色B钻石: _____

---

### 测试6: 金币角色隔离测试 ⭐⭐⭐⭐
**目的**: 验证金币在不同角色间独立

**步骤**:
1. 使用角色A进入冒险，获得一些金币（假设100个）
2. 记录金币数：____
3. 返回角色列表
4. 切换到角色B
5. 角色B进入冒险页面
6. 观察金币数值

**预期结果**:
- ✅ 角色A金币：100
- ✅ 角色B金币：0（或独立的数值）
- ✅ 两个角色金币完全独立

**实际结果**: 
- 角色A金币: _____
- 角色B金币: _____

---

### 测试7: 货币悬停提示测试 ⭐
**目的**: 验证货币的用途说明

**步骤**:
1. 进入冒险页面
2. 将鼠标悬停在💰金币显示上
3. 将鼠标悬停在💎钻石显示上

**预期结果**:
- ✅ 金币悬停显示："角色金币（常规消费）"
- ✅ 钻石悬停显示："账号钻石（特殊道具、跨角色共享）"

**实际结果**: _______________

---

### 测试8: 货币数据保存时机测试 ⭐⭐
**目的**: 验证各种场景下货币正确保存

**场景A - 战斗后保存**:
1. 进入冒险，金币0
2. 击败一个敌人，获得金币
3. 立即刷新页面
4. ✅ 预期：金币保留

**场景B - 离开页面保存**:
1. 获得一些金币
2. 点击"← 返回"
3. 重新进入冒险
4. ✅ 预期：金币保留

**场景C - 定时保存**:
1. 进入冒险页面
2. 等待5秒以上
3. 刷新页面
4. ✅ 预期：数据正常

**实际结果**: _______________

---

### 测试9: 控制台错误检查 ⭐⭐
**目的**: 确保无JavaScript错误

**步骤**:
1. 打开浏览器开发者工具（F12）
2. 切换到Console标签
3. 执行以上所有测试
4. 观察是否有红色错误信息

**预期结果**:
- ✅ 无任何错误
- ✅ 无警告信息
- ✅ localStorage操作成功

**实际结果**: _______________

---

### 测试10: 性能测试 ⭐
**目的**: 验证大量货币数值下的性能

**步骤**:
1. 进入冒险页面
2. 打开浏览器控制台
3. 执行以下命令（手动添加大量货币）:
```javascript
// 获取adventure实例（需要通过Vue DevTools或全局暴露）
// 假设已经能访问到adventure对象
adventure.addGold(999999)
adventure.addDiamond(9999)
```
4. 观察界面显示
5. 刷新页面，验证大数值保存

**预期结果**:
- ✅ 大数值正确显示
- ✅ 刷新后数据保留
- ✅ 界面无卡顿

**实际结果**: _______________

---

## 🐛 已知问题记录

| 问题描述 | 严重程度 | 复现步骤 | 状态 |
|---------|---------|---------|------|
|         |         |         |      |

---

## 📊 测试统计

- **执行日期**: _______________
- **测试人员**: _______________
- **通过测试**: _____ / 10
- **失败测试**: _____ / 10
- **总体评价**: _______________

---

## 🎓 测试技巧

### 快速验证localStorage
打开控制台执行：
```javascript
// 查看所有本地存储
console.log(localStorage)

// 查看特定角色的金币
console.log(localStorage.getItem('character_currency_xxx'))

// 查看账号钻石
console.log(localStorage.getItem('account_currency'))
```

### 手动修改货币（测试用）
```javascript
// 修改金币
localStorage.setItem('character_currency_xxx', JSON.stringify({
  characterId: 'xxx',
  gold: 10000
}))

// 修改钻石
localStorage.setItem('account_currency', JSON.stringify({
  diamond: 5000
}))

// 刷新页面生效
location.reload()
```

### 清除所有数据（重置测试）
```javascript
localStorage.clear()
location.reload()
```

---

## 📝 测试报告模板

### 测试摘要
- **测试版本**: v1.0.0
- **测试环境**: Chrome/Firefox/Safari
- **测试日期**: 2025-10-24

### 关键发现
1. 金币持久化问题已修复 ✅
2. 双货币系统正常工作 ✅
3. 数据隔离和共享机制正确 ✅

### 建议
- [ ] 添加货币消费功能（商店系统）
- [ ] 添加货币兑换功能
- [ ] 优化大数值显示（如：1000 → 1K）

---

**测试完成签名**: _______________
**日期**: _______________
