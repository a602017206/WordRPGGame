# ğŸ”§ æ•…éšœæ’é™¤æŒ‡å—

## "æ— æ•ˆçš„å­˜æ¡£æ•°æ®" é”™è¯¯

å¦‚æœæ‚¨é‡åˆ°"æ— æ•ˆçš„å­˜æ¡£æ•°æ®"é”™è¯¯ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

### ğŸ” æ­¥éª¤ 1: æ£€æŸ¥æ•°æ®æ ¼å¼

**æ­£ç¡®çš„å­˜æ¡£æ ¼å¼å¿…é¡»æ˜¯ï¼š**
```
RPG_SAVE|<æ ¡éªŒå’Œ>|<åŠ å¯†æ•°æ®>
```

**æ£€æŸ¥æ¸…å•ï¼š**
- âœ“ æ˜¯å¦ä»¥ `RPG_SAVE|` å¼€å¤´ï¼Ÿ
- âœ“ æ˜¯å¦åŒ…å«ä¸¤ä¸ª `|` åˆ†éš”ç¬¦ï¼ˆæ€»å…±3éƒ¨åˆ†ï¼‰ï¼Ÿ
- âœ“ æ•°æ®æ˜¯å¦å®Œæ•´ï¼ˆæ²¡æœ‰è¢«æˆªæ–­ï¼‰ï¼Ÿ
- âœ“ æ˜¯å¦åŒ…å«æ¢è¡Œç¬¦æˆ–å…¶ä»–ç©ºç™½å­—ç¬¦ï¼Ÿ

### ğŸ§ª æ­¥éª¤ 2: ä½¿ç”¨æµ‹è¯•å·¥å…·

è®¿é—®æµ‹è¯•é¡µé¢è¿›è¡Œè¯Šæ–­ï¼š
```
http://localhost:5173/test-encryption.html
```

**æµ‹è¯•æ­¥éª¤ï¼š**
1. ç‚¹å‡»"ç”Ÿæˆæµ‹è¯•æ•°æ®"
2. ç‚¹å‡»"åŠ å¯†æµ‹è¯•æ•°æ®"
3. å¤åˆ¶åŠ å¯†ç»“æœ
4. ç²˜è´´åˆ°"è‡ªå®šä¹‰æµ‹è¯•"åŒºåŸŸ
5. ç‚¹å‡»"æµ‹è¯•è§£å¯†"

å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œè¯´æ˜åŠ å¯†ç³»ç»Ÿæ­£å¸¸å·¥ä½œã€‚

### ğŸ” æ­¥éª¤ 3: æ£€æŸ¥æ§åˆ¶å°è¾“å‡º

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š

```javascript
// åœ¨æ§åˆ¶å°æ‰‹åŠ¨æµ‹è¯•
import { encryptSaveData, decryptSaveData } from './src/utils/saveEncryption.js'

const testData = { test: 'data' }
const encrypted = encryptSaveData(testData)
console.log('åŠ å¯†æ•°æ®:', encrypted)

const decrypted = decryptSaveData(encrypted)
console.log('è§£å¯†æ•°æ®:', decrypted)
```

### ğŸ“‹ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

#### é—®é¢˜ 1: æ•°æ®è¢«æˆªæ–­

**ç—‡çŠ¶ï¼š** å¯¼å‡ºçš„æ•°æ®ä¸å®Œæ•´

**è§£å†³æ–¹æ¡ˆï¼š**
- ä½¿ç”¨"å¯¼å‡ºåˆ°æ–‡ä»¶"è€Œä¸æ˜¯å‰ªè´´æ¿
- æ£€æŸ¥å‰ªè´´æ¿å¤§å°é™åˆ¶
- ç¡®ä¿ç²˜è´´æ—¶æ²¡æœ‰é€‰ä¸­éƒ¨åˆ†æ–‡æœ¬

#### é—®é¢˜ 2: åŒ…å«æ¢è¡Œç¬¦

**ç—‡çŠ¶ï¼š** é”™è¯¯æç¤º"å­˜æ¡£æ ¼å¼ä¸æ­£ç¡®"

**è§£å†³æ–¹æ¡ˆï¼š**
```javascript
// å¯¼å…¥å‰æ¸…ç†æ•°æ®
const cleanedData = encryptedData.trim().replace(/\n/g, '')
importSaveFile(cleanedData)
```

#### é—®é¢˜ 3: æ–‡ä»¶å¤´ä¸åŒ¹é…

**ç—‡çŠ¶ï¼š** é”™è¯¯æç¤º"ä¸æ˜¯æœ‰æ•ˆçš„RPGå­˜æ¡£æ–‡ä»¶"

**æ£€æŸ¥ï¼š**
```javascript
const parts = encryptedData.split('|')
console.log('æ–‡ä»¶å¤´:', parts[0])  // åº”è¯¥æ˜¯ "RPG_SAVE"
```

#### é—®é¢˜ 4: æ ¡éªŒå’Œå¤±è´¥

**ç—‡çŠ¶ï¼š** é”™è¯¯æç¤º"å­˜æ¡£æ–‡ä»¶å·²æŸåæˆ–è¢«ç¯¡æ”¹"

**åŸå› ï¼š**
- æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹
- å¤åˆ¶ç²˜è´´æ—¶ä¸¢å¤±äº†å­—ç¬¦
- æ–‡ä»¶ç¼–ç é—®é¢˜

**è§£å†³æ–¹æ¡ˆï¼š**
- é‡æ–°å¯¼å‡ºå­˜æ¡£
- ä½¿ç”¨æ–‡ä»¶æ–¹å¼è€Œä¸æ˜¯å‰ªè´´æ¿
- æ£€æŸ¥æ–‡ä»¶ç¼–ç ï¼ˆåº”è¯¥æ˜¯ UTF-8ï¼‰

#### é—®é¢˜ 5: è§£å¯†å¤±è´¥

**ç—‡çŠ¶ï¼š** é”™è¯¯æç¤º"å­˜æ¡£è§£å¯†å¤±è´¥"

**å¯èƒ½åŸå› ï¼š**
- åŠ å¯†å¯†é’¥ä¸åŒ¹é…
- æ•°æ®æ ¼å¼é”™è¯¯
- Base64 è§£ç å¤±è´¥

**è°ƒè¯•æ­¥éª¤ï¼š**
```javascript
// åœ¨æ§åˆ¶å°è¿è¡Œ
import { getSaveInfo } from './src/utils/saveEncryption.js'

const info = getSaveInfo(encryptedData)
if (info) {
  console.log('å­˜æ¡£ä¿¡æ¯:', info)
} else {
  console.log('æ— æ³•è·å–å­˜æ¡£ä¿¡æ¯ï¼Œæ•°æ®å¯èƒ½æŸå')
}
```

### ğŸ› ï¸ é«˜çº§è°ƒè¯•

#### å¯ç”¨è¯¦ç»†æ—¥å¿—

ç¼–è¾‘ `src/App.vue`ï¼ŒæŸ¥çœ‹å¯¼å…¥è¿‡ç¨‹çš„è¯¦ç»†æ—¥å¿—ï¼š

```javascript
const handleImportSave = (encryptedData) => {
  console.log('=== å¼€å§‹å¯¼å…¥ ===')
  console.log('æ•°æ®é•¿åº¦:', encryptedData.length)
  console.log('å‰100å­—ç¬¦:', encryptedData.substring(0, 100))
  console.log('å100å­—ç¬¦:', encryptedData.substring(encryptedData.length - 100))
  
  // ... åŸæœ‰ä»£ç 
}
```

#### éªŒè¯æ•°æ®å®Œæ•´æ€§

```javascript
// å¯¼å‡ºåç«‹å³éªŒè¯
const encrypted = exportSaveFile()
console.log('å¯¼å‡ºçš„æ•°æ®:', encrypted)

// ç«‹å³å°è¯•å¯¼å…¥
const result = importSaveFile(encrypted)
console.log('éªŒè¯ç»“æœ:', result)
```

### ğŸ“ æ­£ç¡®çš„ä½¿ç”¨æµç¨‹

#### å¯¼å‡ºå­˜æ¡£

```javascript
// æ–¹æ³• 1: å¯¼å‡ºåˆ°å‰ªè´´æ¿
1. ç‚¹å‡»"å¯¼å‡ºåˆ°å‰ªè´´æ¿"
2. æ‰“å¼€æ–‡æœ¬ç¼–è¾‘å™¨
3. ç²˜è´´ (Ctrl+V)
4. ä¿å­˜ä¸º .txt æ–‡ä»¶

// æ–¹æ³• 2: å¯¼å‡ºåˆ°æ–‡ä»¶ï¼ˆæ¨èï¼‰
1. ç‚¹å‡»"å¯¼å‡ºåˆ°æ–‡ä»¶"
2. é€‰æ‹©ä¿å­˜ä½ç½®
3. æ–‡ä»¶è‡ªåŠ¨å‘½åä¸º my_rpg_save_<æ—¶é—´æˆ³>.rpgsave
```

#### å¯¼å…¥å­˜æ¡£

```javascript
// æ–¹æ³• 1: ä»æ–‡ä»¶å¯¼å…¥ï¼ˆæ¨èï¼‰
1. ç‚¹å‡»"å¯¼å…¥å­˜æ¡£"
2. ç‚¹å‡»"ä»æ–‡ä»¶é€‰æ‹©"
3. é€‰æ‹© .rpgsave æ–‡ä»¶
4. è‡ªåŠ¨å¡«å……å’ŒéªŒè¯

// æ–¹æ³• 2: ä»æ–‡æœ¬å¯¼å…¥
1. ç‚¹å‡»"å¯¼å…¥å­˜æ¡£"
2. ç²˜è´´å­˜æ¡£æ•°æ®åˆ°æ–‡æœ¬æ¡†
3. ç‚¹å‡»"éªŒè¯å­˜æ¡£"
4. å¦‚æœéªŒè¯æˆåŠŸï¼Œç‚¹å‡»"ç¡®è®¤å¯¼å…¥"
```

### ğŸ”¬ æ‰‹åŠ¨æµ‹è¯•è„šæœ¬

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œå®Œæ•´æµ‹è¯•ï¼š

```javascript
// 1. å¯¼å…¥å·¥å…·
import { 
  encryptSaveData, 
  decryptSaveData, 
  validateSaveData 
} from './src/utils/saveEncryption.js'

// 2. åˆ›å»ºæµ‹è¯•æ•°æ®
const testData = {
  characters: [{
    id: 'test',
    name: 'æµ‹è¯•',
    level: 1
  }],
  selectedCharacterId: 'test',
  exportDate: new Date().toISOString()
}

// 3. åŠ å¯†
console.log('åŸå§‹æ•°æ®:', testData)
const encrypted = encryptSaveData(testData)
console.log('åŠ å¯†ç»“æœ:', encrypted)
console.log('åŠ å¯†é•¿åº¦:', encrypted.length)

// 4. éªŒè¯
const validation = validateSaveData(encrypted)
console.log('éªŒè¯ç»“æœ:', validation)

// 5. è§£å¯†
const decrypted = decryptSaveData(encrypted)
console.log('è§£å¯†ç»“æœ:', decrypted)

// 6. å¯¹æ¯”
console.log('æ•°æ®ä¸€è‡´:', JSON.stringify(testData) === JSON.stringify(decrypted))
```

### ğŸ“ è·å–å¸®åŠ©

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·ï¼š

1. **æ”¶é›†ä¿¡æ¯ï¼š**
   - æµè§ˆå™¨ç‰ˆæœ¬
   - é”™è¯¯ä¿¡æ¯æˆªå›¾
   - æ§åˆ¶å°æ—¥å¿—
   - å­˜æ¡£æ•°æ®æ ·æœ¬ï¼ˆå‰åå„100å­—ç¬¦ï¼‰

2. **æ£€æŸ¥ç¯å¢ƒï¼š**
   - æµè§ˆå™¨æ˜¯å¦æ”¯æŒ `TextEncoder`/`TextDecoder`
   - æ˜¯å¦ç¦ç”¨äº† JavaScript
   - æ˜¯å¦æœ‰æµè§ˆå™¨æ‰©å±•å¹²æ‰°

3. **é‡ç°é—®é¢˜ï¼š**
   - è¯¦ç»†æè¿°æ“ä½œæ­¥éª¤
   - æä¾›æœ€å°å¯é‡ç°ç¤ºä¾‹

### âœ… éªŒè¯ä¿®å¤

ç¡®è®¤é—®é¢˜å·²è§£å†³ï¼š

```javascript
// å®Œæ•´æµç¨‹æµ‹è¯•
1. åˆ›å»ºä¸€ä¸ªè§’è‰²
2. å¯¼å‡ºå­˜æ¡£
3. æ¸…ç©ºæ‰€æœ‰æ•°æ®
4. å¯¼å…¥ä¹‹å‰çš„å­˜æ¡£
5. éªŒè¯è§’è‰²æ˜¯å¦æ¢å¤

å¦‚æœä»¥ä¸Šæµç¨‹æˆåŠŸï¼Œè¯´æ˜ç³»ç»Ÿæ­£å¸¸å·¥ä½œã€‚
```

---

**æ›´æ–°æ—¥æœŸ:** 2024-10-24  
**ç‰ˆæœ¬:** 1.0
