# 技能系统修复快速测试指南

## 🚀 测试准备（1分钟）

### 启动游戏
```bash
npm run dev
```
访问：http://localhost:5173

### 创建测试角色
- 选择职业：法师（推荐，方便测试多种技能）
- 进入冒险界面

---

## ✅ 测试1：技能正常释放（3分钟）

### 目标
验证使用技能击败敌人后能正确获得奖励

### 步骤

1. **开始战斗**
   - 点击"寻找敌人"
   - 等待敌人出现

2. **使用默认技能**
   - 点击技能按钮（如：🔥 火球术）
   - 观察敌人HP变化
   - 确认MP被正确扣除

3. **击败敌人**
   - 继续使用技能直到敌人HP归零
   - **关键验证点：**
     - [ ] 战斗日志显示"战斗胜利！"
     - [ ] 获得经验值和金币
     - [ ] 金币数量增加（查看顶部货币显示）
     - [ ] 角色经验条增长
     - [ ] 可能有道具掉落提示

4. **检查战斗状态**
   - [ ] 战斗自动结束
   - [ ] 敌人消失
   - [ ] 可以再次点击"寻找敌人"

### 预期结果
```
战斗日志应显示：
[时间] 你使用技能 🔥 火球术
[时间] 造成 45 点伤害！
[时间] 火焰骑士 对你造成了 12 点伤害！
[时间] 你使用技能 🔥 火球术
[时间] 造成 48 点伤害！
[时间] 战斗胜利！获得 30 经验值和 15 金币！✅
```

### ⚠️ 常见问题
- **问题**：击败敌人后战斗未结束
  - **原因**：修复前的bug
  - **解决**：确保使用了最新代码

- **问题**：MP不足无法释放技能
  - **解决**：等待MP自动回复（每2秒+2-5点）或点击"休息"

---

## ✅ 测试2：治疗技能特效（5分钟）

### 目标
验证治疗类技能的特殊效果处理

### 前提条件
- 需要牧师职业角色
- 或获得治疗术技能书并学习

### 步骤

1. **学习治疗术**
   - 战斗直到获得"治疗术技能书"
   - 打开背包，点击"学习"
   - 打开技能管理，装备到槽位

2. **测试治疗效果**
   - 开始战斗
   - 先使用普通攻击受伤
   - 使用治疗术技能
   - **关键验证点：**
     - [ ] HP增加（查看HP条）
     - [ ] 战斗日志显示"恢复 XX 点生命值！"
     - [ ] MP正确扣除
     - [ ] 敌人正常反击（治疗不攻击敌人）

### 预期结果
```
战斗日志应显示：
[时间] 你使用技能 💚 治疗术
[时间] 恢复 40 点生命值！✅
[时间] 史莱姆 对你造成了 8 点伤害！
```

---

## ✅ 测试3：职业信息显示（2分钟）

### 目标
验证技能书和技能详情显示职业信息

### 步骤

1. **查看技能书职业信息**
   - 击败怪物获得技能书
   - 打开背包
   - 找到技能书道具
   - **关键验证点：**
     - [ ] 显示"适用职业：XXX"
     - [ ] 职业名称正确（战士/法师/刺客/牧师/通用）
     - [ ] 样式美观（蓝色边框+背景）

2. **查看已装备技能职业信息**
   - 打开技能管理
   - 切换到"已装备技能"标签
   - 查看任一技能
   - **关键验证点：**
     - [ ] 显示职业标识（如：🔮 法师）
     - [ ] 标识带有图标
     - [ ] 位置在技能描述下方

3. **查看已学习技能职业信息**
   - 切换到"已学习技能"标签
   - 查看技能卡片
   - **关键验证点：**
     - [ ] 每个技能显示职业标识
     - [ ] 标识简洁清晰
     - [ ] 颜色一致（蓝色系）

### 预期界面

**背包中的技能书：**
```
┌─────────────────────────────┐
│ 📕 重斩技能书               │
│ 学习后可获得技能：重斩      │
│                              │
│ ┌────────────────────────┐ │
│ │ 适用职业：⚔️ 战士    │ │✅
│ └────────────────────────┘ │
│                              │
│ 角色绑定  x1                 │
│ [📚 学习]                    │
└─────────────────────────────┘
```

**技能管理界面：**
```
┌─────────────────────────────┐
│ 技能槽 1            [卸载]  │
│                              │
│ 🔥 火球术 Lv.2/10          │
│ 发射火球造成火焰伤害        │
│                              │
│ [ 🔮 法师 ]               ✅│
│                              │
│ 🔥 fire | 💥 37 | 💧 22 MP │
│ ⏱️ 3.7s                     │
│                              │
│ [升级 (200 💰)]             │
└─────────────────────────────┘
```

---

## ✅ 测试4：升级和掉落（3分钟）

### 目标
验证技能击败敌人后的升级和掉落功能

### 步骤

1. **升级测试**
   - 记录当前等级和经验
   - 使用技能击败多个敌人
   - 观察经验条变化
   - **关键验证点：**
     - [ ] 经验值正确增加
     - [ ] 达到升级条件时自动升级
     - [ ] 显示"🎉 恭喜升级！"
     - [ ] 显示属性提升详情
     - [ ] HP和MP自动恢复满

2. **道具掉落测试**
   - 击败5-10个敌人
   - 观察战斗日志
   - **关键验证点：**
     - [ ] 有道具掉落提示
     - [ ] 道具自动添加到背包
     - [ ] 可能掉落技能书
     - [ ] 稀有道具概率正常

### 预期结果
```
战斗日志：
[时间] 战斗胜利！获得 30 经验值和 15 金币！
[时间] 获得道具：🧪 生命药水
[时间] 🎉 恭喜升级！当前等级：2
[时间] 属性提升：HP+12 MP+10 ATK+3 DEF+2 MAG+3 SPD+2
```

---

## 📊 完整测试矩阵

| 测试项 | 操作 | 预期结果 | 状态 |
|--------|------|----------|------|
| 技能伤害计算 | 使用技能攻击 | 正确扣除敌人HP | ⬜ |
| MP消耗 | 使用技能 | 正确扣除MP | ⬜ |
| 技能冷却 | 连续使用技能 | 显示冷却倒计时 | ⬜ |
| 击败敌人 | 技能击杀 | 获得经验和金币 | ⬜ |
| 升级触发 | 经验满足 | 自动升级+属性提升 | ⬜ |
| 道具掉落 | 击败敌人 | 随机掉落道具 | ⬜ |
| 技能书掉落 | 击败敌人 | 概率掉落技能书 | ⬜ |
| 治疗技能 | 使用治疗术 | HP恢复，不攻击敌人 | ⬜ |
| 技能书职业信息 | 查看技能书 | 显示适用职业 | ⬜ |
| 已装备技能职业 | 查看技能槽 | 显示职业标识 | ⬜ |
| 已学习技能职业 | 查看技能列表 | 显示职业标识 | ⬜ |
| 职业图标 | 各处职业显示 | 图标正确显示 | ⬜ |

---

## 🐛 问题排查

### 问题1：技能击败敌人后没有奖励
**症状**：敌人HP归零，但没有经验和金币  
**检查**：
1. 打开浏览器控制台（F12）
2. 查看是否有JavaScript错误
3. 确认代码已正确更新

**解决**：
- 清除浏览器缓存
- 重新加载页面（Ctrl+F5）
- 检查`handleEnemyDefeat`函数是否被调用

### 问题2：职业信息不显示
**症状**：技能书没有显示"适用职业"  
**检查**：
1. 确认是技能书道具（名称含"技能书"）
2. 检查`getSkillBookClassInfo`函数
3. 查看控制台是否有导入错误

**解决**：
- 刷新页面
- 检查SKILL_DATABASE是否正确加载

### 问题3：治疗技能无效
**症状**：使用治疗术没有恢复HP  
**检查**：
1. 确认技能有`effects`属性
2. 检查`effect.type === 'heal'`
3. 查看战斗日志输出

**解决**：
- 检查技能数据定义
- 确认effect处理逻辑

---

## 📝 测试记录模板

```
测试日期：__________
测试人员：__________
浏览器：__________

技能释放测试：
- [ ] 技能正常造成伤害
- [ ] MP正确扣除
- [ ] 冷却时间正常
- [ ] 击败敌人获得奖励
- [ ] 升级检查正常
- [ ] 道具掉落正常

治疗技能测试：
- [ ] HP正确恢复
- [ ] 不攻击敌人
- [ ] 敌人正常反击

职业信息显示：
- [ ] 技能书显示职业
- [ ] 已装备技能显示职业
- [ ] 已学习技能显示职业
- [ ] 职业图标正确

问题记录：
____________________
____________________
____________________
```

---

## ✅ 验收标准

完成以下所有测试后，可认为修复成功：

### 核心功能
- [x] 使用技能击败敌人获得奖励
- [x] 升级逻辑正常触发
- [x] 道具和技能书正常掉落
- [x] 治疗技能特效正常工作

### UI显示
- [x] 技能书显示职业信息
- [x] 技能管理界面显示职业标识
- [x] 职业图标和文字正确
- [x] 样式美观一致

### 无明显Bug
- [x] 没有JavaScript错误
- [x] 战斗流程流畅
- [x] 数据正确保存
- [x] 性能表现良好

---

**测试时间**：约10分钟  
**难度**：简单  
**重要性**：高 ⭐⭐⭐⭐⭐

**测试完成后请勾选所有测试项，并记录任何发现的问题！**
