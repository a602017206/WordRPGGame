# 技能系统完整指南

## 📚 系统概述

本游戏为角色系统新增了完整的多技能功能，包括技能学习、升级、装备和跨角色转移等核心机制。

## 🎯 核心特性

### 1. 技能槽位系统
- **3个技能槽位**：每个角色拥有3个独立的技能槽位
- **默认技能**：新角色自动配备一个基础等级的职业默认技能
- **灵活装备**：可以随时切换装备的技能

### 2. 技能获取方式

#### 默认技能
每个职业在创建时自动获得一个职业专属的默认技能：
- **战士** → 重斩（物理伤害）
- **法师** → 火球术（火焰伤害）
- **刺客** → 背刺（暴击伤害）
- **牧师** → 治疗术（恢复生命）

#### 技能书掉落
- 击败怪物有**30%概率**掉落道具
- 掉落道具中有**30%概率**是技能书
- 技能书掉落规则：
  - 70%概率掉落本职业技能书
  - 30%概率掉落其他职业技能书
  - 稀有度权重：普通50% > 罕见30% > 稀有15% > 史诗4% > 传说1%

### 3. 职业技能限制

#### 技能类型
- **universal**（通用）：所有职业可学
- **warrior**（战士）：仅战士可学
- **mage**（法师）：仅法师可学
- **rogue**（刺客）：仅刺客可学
- **cleric**（牧师）：仅牧师可学

#### 学习限制
- 只能学习本职业或通用类型的技能
- 不同职业无法学习对方的专属技能
- 已学习的技能无法重复学习

## ⚔️ 技能数值体系

### 核心属性

| 属性 | 说明 | 成长机制 |
|------|------|----------|
| **基础伤害** | 技能的基础伤害值 | 每级增加 damageGrowth |
| **伤害倍率** | 基于角色属性的倍率 | 固定值，不随等级变化 |
| **MP消耗** | 释放技能所需魔法值 | 每级增加 mpCostGrowth |
| **冷却时间** | 技能再次使用的间隔 | 每级减少 cooldownReduction |

### 伤害计算公式

```javascript
实际伤害 = 
  (基础伤害 + 成长伤害 × (等级-1)) × 
  伤害倍率 × 
  (1 + 角色属性/100) × 
  随机波动(90%-110%)
```

- **物理技能**：基于角色的**攻击力**
- **魔法技能**：基于角色的**魔法力**

### 技能平衡设计

#### 低级技能（普通）
- 基础伤害：10-30
- MP消耗：0-20
- 冷却时间：0-5秒
- 适合：频繁使用，快速输出

#### 中级技能（罕见/稀有）
- 基础伤害：25-40
- MP消耗：15-35
- 冷却时间：3-12秒
- 适合：战术配合，关键时刻

#### 高级技能（史诗/传说）
- 基础伤害：40-60
- MP消耗：35-45
- 冷却时间：12-20秒
- 适合：决胜技能，爆发输出

## 📈 技能升级系统

### 升级机制
- **最大等级**：所有技能最高可升至Lv.10
- **升级消耗**：需要消耗角色金币
- **成长收益**：
  - 伤害提升
  - 冷却时间缩短
  - MP消耗适度增加（保持平衡）

### 升级费用计算

```javascript
升级费用 = 100 × 当前等级 × 稀有度倍率

稀有度倍率：
- 普通：1.0
- 罕见：1.5
- 稀有：2.0
- 史诗：3.0
- 传说：5.0
```

**示例**：
- 普通技能 Lv.1→2：100金币
- 稀有技能 Lv.5→6：1000金币
- 传说技能 Lv.9→10：4500金币

## 🔄 技能转移系统

### 转移条件
- 需要使用**技能转移水晶**（传说级稀有道具）
- 技能转移水晶为账号绑定道具
- 每次转移消耗1个水晶

### 转移流程
1. 在技能管理界面选择"技能转移"标签
2. 选择要转移的技能
3. 输入目标角色ID
4. 确认转移（自动消耗水晶）
5. 目标角色自动收到对应技能书

### 获取转移水晶
- 击败怪物稀有掉落
- 账号级别共享
- 可在账号背包中查看

## 🎮 使用指南

### 在战斗中使用技能

1. **开始战斗**：点击"寻找敌人"
2. **选择技能**：战斗界面显示已装备的技能按钮
3. **检查状态**：
   - MP是否充足
   - 技能是否在冷却中
4. **释放技能**：点击技能按钮
5. **观察效果**：
   - 战斗日志显示伤害
   - MP自动扣除
   - 冷却开始计时

### 技能管理操作

#### 打开技能管理
- 在冒险界面点击"📚 技能管理"按钮

#### 已装备技能
- 查看3个槽位的技能
- 升级技能（消耗金币）
- 卸载技能

#### 已学习技能
- 查看所有已学习的技能
- 装备技能到指定槽位
- 快速升级技能

#### 技能转移
- 选择要转移的技能
- 输入目标角色ID
- 确认转移（消耗水晶）

## 📊 技能数据库

### 战士技能

| 技能名称 | 稀有度 | 基础伤害 | MP消耗 | 冷却 | 特效 |
|---------|--------|---------|--------|------|------|
| 重斩 | 普通 | 25 | 15 | 3s | 无 |
| 冲锋 | 罕见 | 30 | 25 | 8s | 30%眩晕2秒 |
| 旋风斩 | 稀有 | 40 | 35 | 12s | 范围攻击 |

### 法师技能

| 技能名称 | 稀有度 | 基础伤害 | MP消耗 | 冷却 | 特效 |
|---------|--------|---------|--------|------|------|
| 火球术 | 普通 | 30 | 20 | 4s | 50%灼烧3秒 |
| 寒冰箭 | 罕见 | 28 | 22 | 5s | 70%减速4秒 |
| 闪电链 | 稀有 | 50 | 40 | 15s | 高额魔法伤害 |

### 刺客技能

| 技能名称 | 稀有度 | 基础伤害 | MP消耗 | 冷却 | 特效 |
|---------|--------|---------|--------|------|------|
| 背刺 | 普通 | 35 | 18 | 6s | 暴击伤害 |
| 毒刃 | 罕见 | 20 | 25 | 10s | 90%中毒5秒 |
| 暗影突袭 | 史诗 | 60 | 45 | 18s | 超高爆发 |

### 牧师技能

| 技能名称 | 稀有度 | 基础伤害 | MP消耗 | 冷却 | 特效 |
|---------|--------|---------|--------|------|------|
| 治疗术 | 普通 | 0 | 20 | 8s | 恢复40生命 |
| 神圣惩击 | 罕见 | 35 | 28 | 7s | 神圣伤害 |
| 神圣祝福 | 稀有 | 0 | 35 | 20s | 增益10秒 |

## 💡 策略建议

### 技能搭配

#### 战士推荐配置
- **槽位1**：重斩（常规输出）
- **槽位2**：冲锋（控制技能）
- **槽位3**：旋风斩（爆发伤害）

#### 法师推荐配置
- **槽位1**：火球术（持续输出）
- **槽位2**：寒冰箭（控制减速）
- **槽位3**：闪电链（终结技）

#### 刺客推荐配置
- **槽位1**：背刺（高频暴击）
- **槽位2**：毒刃（持续伤害）
- **槽位3**：暗影突袭（斩杀技）

#### 牧师推荐配置
- **槽位1**：治疗术（生存保障）
- **槽位2**：神圣惩击（输出技能）
- **槽位3**：神圣祝福（增益BUFF）

### 资源分配

#### 金币使用优先级
1. **优先升级主力技能**（槽位1常用技能）
2. **平衡升级其他技能**
3. **保留应急金币**（用于战斗恢复）

#### 技能转移建议
- 转移水晶极其稀有，谨慎使用
- 优先转移高稀有度技能
- 考虑目标角色职业匹配度
- 避免转移职业限制技能

## 🔧 技术实现

### 数据结构
```typescript
interface Skill {
  id: string
  name: string
  description: string
  icon: string
  element: SkillElement
  rarity: SkillRarity
  skillType: SkillType
  level: number
  maxLevel: number
  baseDamage: number
  damageMultiplier: number
  mpCost: number
  cooldown: number
  damageGrowth: number
  mpCostGrowth: number
  cooldownReduction: number
  effects?: SkillEffect[]
}
```

### 存储机制
- **角色技能数据**：localStorage（按角色ID存储）
- **技能冷却状态**：内存Map（临时存储）
- **转移中的技能**：localStorage全局存储

### 关键API
```typescript
// 技能系统
useSkills(character: Character)
  - learnSkill(skill: Skill)
  - equipSkill(skillId: string, slotIndex: number)
  - unequipSkill(slotIndex: number)
  - upgradeSkill(skillId: string, gold: Ref<number>)
  - useSkill(slotIndex: number, currentMp: Ref<number>, stats)

// 冒险系统
useAdventure(character: Character)
  - useSkillBook(skillBookId: string)
  - transferSkillToCharacter(skill: Skill, targetId: string)
  - receiveTransferredSkills()
```

## 📝 注意事项

### 游戏平衡
- MP自动回复机制确保技能可持续使用
- 冷却时间防止技能滥用
- 升级费用控制技能强度增长速度

### 用户体验
- 技能图标和颜色直观显示稀有度
- 冷却倒计时实时显示
- MP不足时自动提示
- 学习限制清晰反馈

### 性能优化
- 技能数据按需加载
- 冷却状态本地计算
- 自动保存机制（每5秒）

## 🎯 后续扩展

可能的扩展方向：
1. **技能组合系统**：特定技能组合触发额外效果
2. **技能天赋树**：深度定制技能发展方向
3. **技能符文系统**：强化技能特定属性
4. **技能成就系统**：使用技能解锁成就
5. **技能竞技场**：PvP技能对战模式

---

**版本**：1.0  
**更新日期**：2025-10-24  
**维护者**：RPG Game Development Team
